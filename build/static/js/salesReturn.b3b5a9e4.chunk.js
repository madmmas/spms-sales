"use strict";(self.webpackChunkspms_app=self.webpackChunkspms_app||[]).push([[3101],{9615:function(e,n,t){t.d(n,{Aq:function(){return i},Cg:function(){return c},Hf:function(){return r},IE:function(){return l},PC:function(){return m},PV:function(){return u},Qx:function(){return d},UM:function(){return h},UY:function(){return s},_q:function(){return f},pe:function(){return a},wu:function(){return o}});var r="onStockInPackageProduct",a="onSalesProduct",s="onCancelSalesOrder",o="onConfirmSalesOrder",i="onExpenseFromCash",l="onExpenseFromBank",u="onExtraIncomeToCash",c="onExtraIncomeToBank",d="onCashToBank",f="onBankToCash",m="onDamagedStock",h="onStockAdjustment"},2490:function(e,n,t){t.r(n),t.d(n,{default:function(){return R}});var r=t(3433),a=t(9439),s=t(2791),o=t(7689),i=t(919),l=t(7580),u=t(1811),c=t(9615),d=t(9565),f=t(9195),m=t(989),h=t(8218),p=t(5854),x=t(4286),g=t(184),y=function(e){var n=e.trigger,t=e.onCancelOrder,r=(0,s.useState)(!1),o=(0,a.Z)(r,2),l=o[0],u=(o[1],(0,s.useState)(!1)),c=(0,a.Z)(u,2),d=c[0],y=c[1],v=(0,f.cI)({defaultValues:{cancelRemarks:"",cancelationCharge:0}}),j=v.control,b=v.formState.errors,S=v.handleSubmit;(0,s.useEffect)((function(){n&&y(!d)}),[n]);var C=function(e){return b[e]&&(0,g.jsx)("small",{className:"p-error",children:b[e].message})},R=function(){y(!1)},N=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-text",onClick:R}),(0,g.jsx)(i.z,{disabled:l,label:"Confirm",icon:"pi pi-check",className:"p-button-text",onClick:S((function(e){return t(e)}))})]});return(0,g.jsx)(x.V,{visible:d,style:{width:"450px"},header:"Payment",modal:!0,className:"p-fluid",footer:N,onHide:R,children:(0,g.jsxs)("div",{className:"p-fluid formgrid grid",children:[(0,g.jsx)("div",{className:"field col-12 md:col-12",children:(0,g.jsx)(f.Qr,{name:"cancelationCharge",control:j,render:function(e){var n=e.field,t=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("label",{htmlFor:"cancelationCharge",children:"Additional Charge"}),(0,g.jsx)(m.R,{inputId:n.name,value:n.value,inputRef:n.payRef,onValueChange:function(e){return n.onChange(e)},className:(0,p.AK)({"p-invalid":t.error})}),C(n.name)]})}})}),(0,g.jsx)("div",{className:"field col-12 md:col-12",children:(0,g.jsx)(f.Qr,{name:"cancelRemarks",control:j,rules:{required:"Remarks is required."},render:function(e){var n=e.field,t=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("label",{htmlFor:"cancelRemarks",children:"Remarks*"}),(0,g.jsx)(h.g,{inputId:n.name,value:n.value,inputRef:n.payRef,keyfilter:"text",className:(0,p.AK)({"p-invalid":t.error}),onChange:function(e){return n.onChange(e.target.value)},rows:3,cols:20}),C(n.name)]})}})})]})})},v=function(e){var n=e.trigger,t=e.confirmOrder,r=(0,s.useState)(!1),o=(0,a.Z)(r,2),l=o[0],u=(o[1],(0,s.useState)(!1)),c=(0,a.Z)(u,2),d=c[0],m=c[1],y=(0,f.cI)({defaultValues:{notes:""}}),v=y.control,j=y.formState.errors,b=y.handleSubmit;(0,s.useEffect)((function(){n&&m(!d)}),[n]);var S=function(){m(!1)},C=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-text",onClick:S}),(0,g.jsx)(i.z,{disabled:l,label:"Confirm",icon:"pi pi-check",className:"p-button-text",onClick:b((function(e){return t(e)}))})]});return(0,g.jsx)(x.V,{visible:d,style:{width:"450px"},header:"Payment",modal:!0,className:"p-fluid",footer:C,onHide:S,children:(0,g.jsx)("div",{className:"p-fluid formgrid grid",children:(0,g.jsx)("div",{className:"field col-12 md:col-12",children:(0,g.jsx)(f.Qr,{name:"notes",control:v,rules:{required:"Note is required."},render:function(e){var n,t=e.field,r=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("label",{htmlFor:"notes",children:"Note*"}),(0,g.jsx)(h.g,{inputId:t.name,value:t.value,inputRef:t.payRef,keyfilter:"text",className:(0,p.AK)({"p-invalid":r.error}),onChange:function(e){return t.onChange(e.target.value)},rows:3,cols:20}),(n=t.name,j[n]&&(0,g.jsx)("small",{className:"p-error",children:j[n].message}))]})}})})})})},j=t(1063),b=t(7145),S=function(e){var n=e.enableReturn,t=e.items,r=e.addToSalesReturn,o=(0,s.useState)({}),l=(0,a.Z)(o,2);l[0],l[1];(0,s.useEffect)((function(){console.log("items:::   ",t)}),[]);return(0,g.jsxs)(b.w,{value:t,stripedRows:!0,showGridlines:!0,scrollable:!0,scrollHeight:"25rem",children:[n&&(0,g.jsx)(j.s,{body:function(e){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(i.z,{icon:"pi pi-pencil",className:"p-button-rounded p-button-success mr-2",onClick:function(){return r(e)}})})},frozen:!0,headerStyle:{minWidth:"6.4rem"}}),(0,g.jsx)(j.s,{field:"productName",frozen:!0,header:"Product Name",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"brandName",header:"Brand Name",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"modelNo",header:"Model No",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"partNumber",header:"Part Number",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"quantity",header:"Quantity",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"returned",header:"Returned",headerStyle:{minWidth:"10rem"}}),n&&(0,g.jsx)(j.s,{field:"returnQuantity",header:"Return Qty",headerStyle:{minWidth:"10rem"}}),n&&(0,g.jsx)(j.s,{field:"returnReason",header:"Return Reason",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"unitTradePrice",header:"Trade Price",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"discountedAmount",header:"Discounted Amount",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"netPrice",header:"Net Cost",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"lastSalePrice",header:"Last Sale Price",headerStyle:{minWidth:"10rem"}}),(0,g.jsx)(j.s,{field:"remarks",header:"Remarks",headerStyle:{minWidth:"10rem"}})]})},C=function(e){var n=e.trigger,t=e.selectedItem,r=e.addToSalesReturn,o=(0,s.useState)(!1),l=(0,a.Z)(o,2),u=l[0],c=(l[1],(0,s.useState)(!1)),d=(0,a.Z)(c,2),y=d[0],v=d[1],j=(0,s.useState)(0),b=(0,a.Z)(j,2),S=b[0],C=b[1],R=(0,s.useState)(0),N=(0,a.Z)(R,2),k=(N[0],N[1]),P=(0,f.cI)({defaultValues:{productId:"",returnReason:"",returnQuantity:0,returnAmount:0,returnableQty:0}}),w=P.control,Z=P.formState.errors,I=P.handleSubmit;(0,s.useEffect)((function(){console.log("selectedItem:::   ",t),C(t.quantity-(t.returned||0)),k(t.netPrice/t.quantity)}),[t]),(0,s.useEffect)((function(){n&&v(!y)}),[n]);var O=function(e){return Z[e]&&(0,g.jsx)("small",{className:"p-error",children:Z[e].message})},F=function(){v(!1)},E=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-text",onClick:F}),(0,g.jsx)(i.z,{disabled:u,label:"Confirm",icon:"pi pi-check",className:"p-button-text",onClick:I((function(e){return function(e){console.log("addToReturn:::   ",e);var n={productId:t._id,returnReason:e.returnReason,returnQuantity:e.returnQuantity,returnAmount:t.itemUnitPrice*e.returnQuantity};r(n),v(!1)}(e)}))})]});return(0,g.jsx)(x.V,{visible:y,style:{width:"450px"},header:"Payment",modal:!0,className:"p-fluid",footer:E,onHide:F,children:(0,g.jsxs)("div",{className:"p-fluid formgrid grid",children:[(0,g.jsx)("div",{className:"field col-12 md:col-12",children:(0,g.jsx)(f.Qr,{name:"returnQuantity",control:w,rules:{required:"Return Quantity is required.",max:S},render:function(e){var n=e.field,t=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("label",{htmlFor:"returnQuantity",children:"Return Quantity*"}),(0,g.jsx)(m.R,{inputId:n.name,value:n.value,inputRef:n.payRef,onValueChange:function(e){return n.onChange(e)},className:(0,p.AK)({"p-invalid":t.error})}),O(n.name)]})}})}),(0,g.jsx)("div",{className:"field col-12 md:col-12",children:(0,g.jsx)(f.Qr,{name:"returnReason",control:w,rules:{required:"Remarks is required."},render:function(e){var n=e.field,t=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("label",{htmlFor:"returnReason",children:"Return Reason*"}),(0,g.jsx)(h.g,{inputId:n.name,value:n.value,inputRef:n.payRef,keyfilter:"text",className:(0,p.AK)({"p-invalid":t.error}),onChange:function(e){return n.onChange(e.target.value)},rows:3,cols:20}),O(n.name)]})}})})]})})},R=function(e){var n=e.sales,t=(u.Id,(0,s.useRef)(null)),f=(0,s.useState)(0),m=(0,a.Z)(f,2),h=m[0],p=m[1],x=(0,s.useState)(0),j=(0,a.Z)(x,2),b=j[0],R=j[1],N=(0,s.useState)(0),k=(0,a.Z)(N,2),P=k[0],w=k[1],Z=(0,s.useState)(!1),I=(0,a.Z)(Z,2),O=I[0],F=I[1],E=(0,s.useState)([]),z=(0,a.Z)(E,2),A=z[0],T=z[1],Q=(0,s.useState)(!1),K=(0,a.Z)(Q,2),W=K[0],q=K[1],B=(0,s.useState)(null),D=(0,a.Z)(B,2),V=D[0],H=D[1],U=(0,s.useState)([]),_=(0,a.Z)(U,2),L=_[0],M=_[1],Y=((0,o.s0)(),new d.p);(0,s.useEffect)((function(){console.log("SALES:::   ",n),T(n.items),F("CONDITIONAL"===n.customerCategory&&"PENDING"===n.salesStatus),q("CONDITIONAL"!==n.customerCategory)}),[]);return(0,g.jsxs)("div",{className:"col-12",children:[(0,g.jsx)(l.F,{ref:t}),(0,g.jsx)("h3",{children:"Sales Return"}),(0,g.jsxs)("div",{class:"grid",children:[O&&(0,g.jsxs)("div",{class:"col-12",children:[(0,g.jsx)(i.z,{type:"submit",label:"Cancel Order",className:"p-button-outlined p-button-warning",onClick:function(){return console.log("cancelOrder:::   "),void p((function(e){return e+1}))}})," \xa0",(0,g.jsx)(i.z,{type:"submit",label:"Confirm Order",className:"p-button p-button-success",onClick:function(){return console.log("confirmOrder:::   "),void R((function(e){return e+1}))}})]}),!O&&(0,g.jsxs)("div",{class:"col-12",children:[(0,g.jsx)(i.z,{type:"submit",label:"Submit Return",className:"p-button p-button-success",onClick:function(){console.log("returnSalesOrder:::   ",L)}})," \xa0"]}),(0,g.jsx)("div",{class:"col-12",children:(0,g.jsxs)("div",{class:"grid",children:[(0,g.jsx)("table",{className:"col-6",children:(0,g.jsxs)("tbody",{children:[(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(0,g.jsx)("b",{children:"Invoice No:"})}),(0,g.jsx)("td",{children:n.voucherNo})]}),(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(0,g.jsx)("b",{children:"Customer Name:"})}),(0,g.jsx)("td",{children:n.customerName})]}),(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(0,g.jsx)("b",{children:"Customer Address:"})}),(0,g.jsx)("td",{children:n.customerAddress})]}),(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(0,g.jsx)("b",{children:"Customer Mobile No:"})}),(0,g.jsx)("td",{children:n.customerMobileNumber})]})]})}),n.isPaid&&(0,g.jsx)("div",{class:"card col-6",children:"Payment Detail"})]})}),(0,g.jsx)("div",{class:"card col-12",children:(0,g.jsx)(S,{enableReturn:W,items:A,addToSalesReturn:function(e){console.log("showSalesReturnDialog:::   ",e),H(e),w((function(e){return e+1}))}})})]}),(0,g.jsx)(y,{trigger:h,onCancelOrder:function(e){return function(e){console.log("onCancelOrder:::   ",e),p((function(e){return e+1}));var r={salesOrderId:n._id,cancelRemarks:e.cancelRemarks,cancelationCharge:e.cancelationCharge};try{Y.processTransaction(c.UY,r).then((function(e){null===e?t.current.show({severity:"error",summary:"Error",detail:"Failed to Cancel",life:3e3}):t.current.show({severity:"success",summary:"Successful",detail:"Sale Order Cancelled",life:3e3})}))}catch(a){t.current.show({severity:"error",summary:"Error",detail:"Failed to Cancel",life:3e3})}}(e)}}),(0,g.jsx)(v,{trigger:b,confirmOrder:function(e){return function(e){console.log("onConfirmOrder:::   ",e),R((function(e){return e+1}));var r={salesOrderId:n._id,notes:e.notes};try{Y.processTransaction(c.wu,r).then((function(e){null===e?t.current.show({severity:"error",summary:"Error",detail:"Failed to Confirm",life:3e3}):t.current.show({severity:"success",summary:"Successful",detail:"Sale Order Confirmed",life:3e3})}))}catch(a){t.current.show({severity:"error",summary:"Error",detail:"Failed to Cancel",life:3e3})}}(e)}}),(0,g.jsx)(C,{trigger:P,selectedItem:V,addToSalesReturn:function(e){return function(e){console.log("addToSalesReturn:::   ",e);var n={productId:e.productId,returnQuantity:e.returnQuantity,returnAmount:e.returnAmount,returnReason:e.returnReason};console.log("addToSalesReturn:::   ",n),M((function(e){return[].concat((0,r.Z)(e),[n])}))}(e)}})]})}},9565:function(e,n,t){t.d(n,{p:function(){return l}});var r=t(4165),a=t(5861),s=t(5671),o=t(3144),i=t(8290),l=function(){function e(){(0,s.Z)(this,e)}return(0,o.Z)(e,[{key:"getById",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.ZP.get("/trxdata/".concat(n,"/").concat(t));case 2:return a=e.sent,console.log(a.data),e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"getLedgerByParty",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.ZP.get("/ledger/".concat(n));case 2:return t=e.sent,console.log(t.data),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"getLedgerByPartyId",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.ZP.get("/ledger/".concat(n,"/").concat(t));case 2:return a=e.sent,console.log(a.data),e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t?Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&"):"",e.abrupt("return",i.ZP.get("/trxdata/".concat(n,"?")+a).then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"processTransaction",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.ZP.post("/transaction/".concat(n),t);case 2:return a=e.sent,console.log(a.data),e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}]),e}()},8218:function(e,n,t){t.d(n,{g:function(){return u}});var r=t(2791),a=t(8820),s=t(3574),o=t(5854);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i.apply(this,arguments)}var l={defaultProps:{__TYPE:"InputTextarea",autoResize:!1,keyfilter:null,onBlur:null,onFocus:null,onInput:null,onKeyDown:null,onKeyUp:null,onPaste:null,tooltip:null,tooltipOptions:null,validateOnly:!1,children:void 0},getProps:function(e){return o.gb.getMergedProps(e,l.defaultProps)},getOtherProps:function(e){return o.gb.getDiffProps(e,l.defaultProps)}},u=r.memo(r.forwardRef((function(e,n){var t=l.getProps(e),u=r.useRef(n),c=r.useRef(0),d=function(e){var n=u.current;n&&o.p7.isVisible(n)&&(c.current||(c.current=n.scrollHeight,n.style.overflow="hidden"),(c.current!==n.scrollHeight||e)&&(n.style.height="",n.style.height=n.scrollHeight+"px",parseFloat(n.style.height)>=parseFloat(n.style.maxHeight)?(n.style.overflowY="scroll",n.style.height=n.style.maxHeight):n.style.overflow="hidden",c.current=n.scrollHeight))},f=u.current&&u.current.value,m=r.useMemo((function(){return o.gb.isNotEmpty(t.value)||o.gb.isNotEmpty(t.defaultValue)||o.gb.isNotEmpty(f)}),[t.value,t.defaultValue,f]);r.useEffect((function(){o.gb.combinedRefs(u,n)}),[u,n]),r.useEffect((function(){t.autoResize&&d(!0)}),[t.autoResize]);var h=o.gb.isNotEmpty(t.tooltip),p=l.getOtherProps(t),x=(0,o.AK)("p-inputtextarea p-inputtext p-component",{"p-disabled":t.disabled,"p-filled":m,"p-inputtextarea-resizable":t.autoResize},t.className);return r.createElement(r.Fragment,null,r.createElement("textarea",i({ref:u},p,{className:x,onFocus:function(e){t.autoResize&&d(),t.onFocus&&t.onFocus(e)},onBlur:function(e){t.autoResize&&d(),t.onBlur&&t.onBlur(e)},onKeyUp:function(e){t.autoResize&&d(),t.onKeyUp&&t.onKeyUp(e)},onKeyDown:function(e){t.onKeyDown&&t.onKeyDown(e),t.keyfilter&&a.F.onKeyPress(e,t.keyfilter,t.validateOnly)},onInput:function(e){t.autoResize&&d(),t.onInput&&t.onInput(e);var n=e.target;o.gb.isNotEmpty(n.value)?o.p7.addClass(n,"p-filled"):o.p7.removeClass(n,"p-filled")},onPaste:function(e){t.onPaste&&t.onPaste(e),t.keyfilter&&a.F.onPaste(e,t.keyfilter,t.validateOnly)}})),h&&r.createElement(s.u,i({target:u,content:t.tooltip},t.tooltipOptions)))})));u.displayName="InputTextarea"}}]);
//# sourceMappingURL=salesReturn.b3b5a9e4.chunk.js.map