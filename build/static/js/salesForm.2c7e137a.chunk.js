"use strict";(self.webpackChunkspms_app=self.webpackChunkspms_app||[]).push([[6749],{3384:function(e,t,n){n.d(t,{Ey:function(){return s},F0:function(){return o},LS:function(){return r},MX:function(){return l},bq:function(){return c},gX:function(){return a},ox:function(){return h},rA:function(){return p},v6:function(){return m},wA:function(){return i},wU:function(){return u},wo:function(){return f},y7:function(){return d}});var r=[{id:"BANK",name:"BANK"},{id:"CASH",name:"CASH"}],a=[{id:"A+",name:"A+"},{id:"A-",name:"A-"},{id:"B+",name:"B+"},{id:"B-",name:"B-"},{id:"AB+",name:"AB+"},{id:"AB-",name:"AB-"},{id:"O+",name:"O+"},{id:"O-",name:"O-"}],l=[{id:"Dhaka",name:"Dhaka"},{id:"Rajshahi",name:"Rajshahi"},{id:"Chitagong",name:"Chitagong"},{id:"Sylhet",name:"Sylhet"},{id:"Khulna",name:"Khulna"}],i=[{id:"BDT",name:"BDT"},{id:"INR",name:"INR"},{id:"USD",name:"USD"},{id:"EUR",name:"EUR"},{id:"GBP",name:"GBP"},{id:"AUD",name:"AUD"},{id:"CAD",name:"CAD"}],o=[{id:"CASH",name:"Cash"},{id:"MFS",name:"MFS"},{id:"BANK",name:"Bank Deposit"}],s=[{id:"WALKIN",name:"Walk-in"},{id:"REGISTERED",name:"Registered"},{id:"CONDITIONAL",name:"Conditional"}],c=[{id:"ADD",name:"Addition"},{id:"REDUCE",name:"Reduction"}],u=[{id:"DHAKA",name:"DHAKA"},{id:"CUMILLA",name:"CUMILLA"},{id:"KHULNA",name:"KHULNA"}],d=[{id:"MALE",name:"Male"},{id:"FEMALE",name:"Female"}],m=[{id:"PART-TIMER",name:"Part-Timer"},{id:"CONTRACTUAL",name:"Contractual"},{id:"PERMANENT",name:"Permanent"}],f=[{id:"MARRIED",name:"Married"},{id:"DIVORCED",name:"Divorced"},{id:"SEPARATED",name:"Separated"},{id:"WIDOWED",name:"Widowed"},{id:"NEVERMARRIED",name:"Never Married"}],p=[{id:"PCS",name:"PCS"},{id:"DZN",name:"DZN"},{id:"PKT",name:"PKT"},{id:"SET",name:"SET"}],h=[{id:"MUSLIM",name:"Muslim"},{id:"HINDU",name:"Hindu"},{id:"CHRISTIAN",name:"Christian"},{id:"BUDDHA",name:"Buddha"},{id:"OTHER",name:"Other"}]},1205:function(e,t,n){var r=n(1413),a=n(9439),l=n(2791),i=n(9195),o=n(5103),s=n(5533),c=n(8218),u=n(919),d=n(5854),m=n(9856),f=(n(1427),n(3956)),p=(n(3384),n(1811)),h=n(184);t.Z=function(e){var t=e.trigger,n=e.initPayment,v=e.onPaymnetCallback,x=e.readOnly,g=void 0!==x&&x,y=(0,l.useState)(!1),j=(0,a.Z)(y,2),b=j[0],N=j[1],S=(0,l.useState)(!1),C=(0,a.Z)(S,2),_=C[0],A=C[1],P=(0,l.useState)("CASH"),I=(0,a.Z)(P,2),R=(I[0],I[1],(0,i.cI)({defaultValues:n})),F=R.control,Z=R.formState.errors,E=(R.setValue,R.reset),w=R.handleSubmit;(0,l.useEffect)((function(){n&&E((0,r.Z)({},n))}),[n]),(0,l.useEffect)((function(){t&&A(!0)}),[t]);var k=function(e){return Z[e]&&(0,h.jsx)("small",{className:"p-error",children:Z[e].message})},O=function(){A(!1)},D=(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(u.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-text",onClick:O}),(0,h.jsx)(u.z,{disabled:b,label:"Save",icon:"pi pi-check",className:"p-button-text",onClick:w((function(e){return function(e){if(N(!1),O(),v){var t=(0,r.Z)((0,r.Z)({},e),{},{ref_id:n.ref_id,ref_type:n.ref_type,payment_type:n.payment_type});console.log("PAYMENT-1:::",n),console.log("PAYMENT-2:::",e),console.log("PAYMENT-3:::",t),v(t)}}(e)}))})]});return(0,h.jsx)(m.V,{visible:_,style:{width:"450px"},header:"Payment",modal:!0,className:"p-fluid",footer:D,onHide:O,children:(0,h.jsxs)("div",{className:"p-fluid formgrid grid",children:[(0,h.jsx)("div",{className:"field col-12 md:col-12",children:(0,h.jsx)(i.Qr,{name:"current_balance",control:F,render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"current_balance",children:"Current Balance*"}),(0,h.jsx)(s.R,{readOnly:!0,inputId:t.name,value:t.value,inputRef:t.ref,onValueChange:function(e){return t.onChange(e)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})}),(0,h.jsxs)("div",{className:"grid",children:[(0,h.jsx)("div",{className:"field col-7 md:col-7",children:(0,h.jsx)(i.Qr,{name:"bank_account_id",control:F,render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:t.name,className:(0,d.AK)({"p-error":Z.value}),children:"Bank Name*"}),(0,h.jsx)(f.Z,{field:t,modelName:p.q$,displayField:"accName",showFields:["dtBank_id","accNumber","accName"],onSelect:function(e){console.log(e)},className:(0,d.AK)({"p-invalid":n.error}),columns:[{field:"dtBank_id_shortname",header:"Bank Name",filterPlaceholder:"Filter by Bank Name"},{field:"accNumber",header:"Account Number",filterPlaceholder:"Filter by Account Number"},{field:"accName",header:"Account Name",filterPlaceholder:"Filter by Account Name"}]}),k(t.name)]})}})}),(0,h.jsx)("div",{className:"field col-5 md:col-5",children:(0,h.jsx)(i.Qr,{name:"bank_amount",control:F,rules:{validate:function(e){return e>0||"Enter a valid amount."}},render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"amount",children:"Bank Amount"}),(0,h.jsx)(s.R,{inputId:t.name,value:t.value,inputRef:t.ref,onValueChange:function(e){return t.onChange(e)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})})]}),(0,h.jsxs)("div",{className:"p-fluid formgrid grid",children:[(0,h.jsx)("div",{className:"field col-12 md:col-7",children:(0,h.jsx)(i.Qr,{name:"reference",control:F,render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"reference",children:"MFS Ref"}),(0,h.jsx)(o.o,{inputId:t.name,value:t.value,inputRef:t.ref,onChange:function(e){return t.onChange(e.target.value)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})}),(0,h.jsx)("div",{className:"field col-12 md:col-5",children:(0,h.jsx)(i.Qr,{name:"mfs_amount",control:F,rules:{validate:function(e){return e>0||"Enter a valid amount."}},render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"amount",children:"MFS Amount"}),(0,h.jsx)(s.R,{inputId:t.name,value:t.value,inputRef:t.ref,onValueChange:function(e){return t.onChange(e)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})})]}),(0,h.jsx)("div",{className:"field col-12 md:col-12",children:(0,h.jsx)(i.Qr,{name:"cash_amount",control:F,rules:{validate:function(e){return e>0||"Enter a valid amount."}},render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"amount",children:"Cash Amount"}),(0,h.jsx)(s.R,{inputId:t.name,value:t.value,inputRef:t.ref,onValueChange:function(e){return t.onChange(e)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})}),(0,h.jsx)("div",{className:"field col-12 md:col-12",children:(0,h.jsx)(i.Qr,{name:"amount",control:F,rules:{validate:function(e){return e>0||"Enter a valid amount."}},render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"amount",children:"Pay Amount*"}),(0,h.jsx)(s.R,{readOnly:g,inputId:t.name,value:t.value,inputRef:t.ref,onValueChange:function(e){return t.onChange(e)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})}),(0,h.jsx)("div",{className:"field col-12 md:col-12",children:(0,h.jsx)(i.Qr,{name:"remarks",control:F,render:function(e){var t=e.field,n=e.fieldState;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("label",{htmlFor:"remarks",children:"Remarks*"}),(0,h.jsx)(c.g,{inputId:t.name,value:t.value,inputRef:t.ref,onChange:function(e){return t.onChange(e.target.value)},className:(0,d.AK)({"p-invalid":n.error})}),k(t.name)]})}})})]})})}},1427:function(e,t,n){n.d(t,{Z:function(){return l}});n(2791);var r=n(3014),a=n(184);function l(e){var t=e.field,n=e.className,l=e.data,i=e.onSelectChange,o=e.placeholder,s=void 0===o?"":o;return(0,a.jsx)(r.L,{value:t.value,onChange:function(e){return function(e){t.onChange(e.value),console.log(e.value),i&&i(e.value)}(e)},options:l,optionValue:"id",optionLabel:"name",placeholder:s,className:n})}},6008:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(1413),a=n(9439),l=n(2791),i=n(2971),o=n(1063),s=n(5103),c=n(3985),u=n(184);function d(e){var t=e.defaultFilters,n=e.selectedItem,d=e.fieldValue,m=e.onSelect,f=(e.modelName,e.columns),p=(e.showFields,(0,l.useRef)(null)),h=(0,l.useRef)(null),v=(0,l.useState)(!1),x=(0,a.Z)(v,2),g=x[0],y=x[1],j=(0,l.useState)(""),b=(0,a.Z)(j,2),N=b[0],S=b[1],C=(0,l.useState)(0),_=(0,a.Z)(C,2),A=_[0],P=_[1],I=(0,l.useState)(t),R=(0,a.Z)(I,2),F=R[0],Z=R[1],E=(0,l.useState)([]),w=(0,a.Z)(E,2),k=w[0],O=w[1],D=new c.M;(0,l.useEffect)((function(){T()}),[]),(0,l.useEffect)((function(){y(!0),D.getAll(F).then((function(e){console.log(e),P(e.total),O(e.rows),y(!1)}))}),[F]);var T=function(){Z(t),S("")},K=function(e){return e.id!==d};return(0,u.jsxs)("div",{style:{minHeight:"30rem"},children:[(0,u.jsxs)("span",{className:"p-input-icon-left",children:[(0,u.jsx)("i",{className:"pi pi-search"}),(0,u.jsx)(s.o,{value:N,onChange:function(e){var t=(0,r.Z)({},F),n=e.target.value;S(n),null!==n&&void 0!==n&&(t.filters.global.value=n,t.first=0,Z(t))},onClick:function(e){h.current.show(e)},onFocus:function(e){e.target.select()},placeholder:"Search"})]}),(0,u.jsxs)(i.w,{ref:p,value:k,dataKey:"id",className:"datatable-responsive",responsiveLayout:"scroll",lazy:!0,loading:g,rows:F.rows,onSort:function(e){var t=(0,r.Z)((0,r.Z)({},F),e);Z(t)},sortField:F.sortField,sortOrder:F.sortOrder,onFilter:function(e){var t=(0,r.Z)((0,r.Z)({},F),e);t.first=0,Z(t)},filterDisplay:"row",filters:F.filters,isDataSelectable:function(e){return!e.data||K(e.data)},rowClassName:function(e){return K(e)?"":"p-disabled"},columnResizeMode:"expand",resizableColumns:!0,scrollable:!0,scrollHeight:"flex",tableStyle:{minWidth:"50rem"},paginator:!0,totalRecords:A,onPage:function(e){var t=(0,r.Z)((0,r.Z)({},F),e);Z(t)},first:F.first,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,15],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",globalFilterFields:["name"],selectionMode:"single",selection:n,onSelectionChange:function(e){e.value&&function(e){null!==h.current&&void 0!==h&&null!==h&&h.current.hide(),S(""),m(e)}(e)},emptyMessage:"No data found.",children:[(0,u.jsx)(o.s,{selectionMode:"single",headerStyle:{minWidth:"3rem"}}),f.map((function(e,t){return(0,u.jsx)(o.s,{field:e.field,header:e.header,filter:!0,filterPlaceholder:e.filterPlaceholder,sortable:!0,headerStyle:{minWidth:e.minWidth}},t)}))]})]})}},9e3:function(e,t,n){n.r(t),n.d(t,{default:function(){return B}});var r=n(3433),a=n(4165),l=n(1413),i=n(5861),o=n(7762),s=n(9439),c=n(2791),u=n(7689),d=n(9195),m=n(2426),f=n(5103),p=n(8218),h=n(7890),v=n(919),x=n(7580),g=n(3428),y=n(5854),j=n(1063),b=n(2971),N=n(9856),S=n(9351),C=n(1427),_=n(6008),A=n(3956),P=n(3384),I=n(1811),R=n(1205),F=n(3620),Z=n(4457),E=n(5533),w=n(7083),k=n(8173),O=n(184),D=function(e){var t=e.salesItems,n=e.editMode,l=e.returnMode,o=e.onReturnItem,u=e.onEdit,d=e.onDelete,m=e.onChangeVat,f=e.onChangeDeliveryCost,p=e.onChangeAdditionalDiscount,h=e.vat,x=e.deliveryCost,g=e.addDiscount,y=(0,c.useState)(0),S=(0,s.Z)(y,2),C=S[0],_=S[1],A=(0,c.useState)(0),P=(0,s.Z)(A,2),I=P[0],R=P[1],F=(0,c.useState)(0),Z=(0,s.Z)(F,2),D=Z[0],T=Z[1],K=(0,c.useState)(0),M=(0,s.Z)(K,2),L=M[0],V=M[1],z=(0,c.useState)(0),B=(0,s.Z)(z,2),q=(B[0],B[1]),H=(0,c.useState)(0),Q=(0,s.Z)(H,2),W=Q[0],U=Q[1],G=(0,c.useState)(0),Y=(0,s.Z)(G,2),X=Y[0],J=Y[1],$=(0,c.useState)(0),ee=(0,s.Z)($,2),te=ee[0],ne=ee[1],re=(0,c.useState)(0),ae=(0,s.Z)(re,2),le=ae[0],ie=ae[1],oe=(0,c.useState)([]),se=(0,s.Z)(oe,2),ce=se[0],ue=se[1],de=(0,c.useState)(null),me=(0,s.Z)(de,2),fe=me[0],pe=me[1],he=(0,c.useState)(!1),ve=(0,s.Z)(he,2),xe=ve[0],ge=ve[1];(0,c.useEffect)((function(){console.log("HELOO:::",t),t&&(ne(h),J(x),V(g),be(t),je(t))}),[t,h,x]);var ye=function(e){return Math.round(100*(e+Number.EPSILON))/100},je=function(e){var t,n,r=0,a=0,l=0;e.forEach((function(e){console.log("ALLSALES::",e),r+=Number(e.trade_price)*Number(e.qty),a+=Number(e.trade_price)*Number(e.qty)*Number(e.discount_profit)/100,l+=Number(e.qty)})),n=r-a-L+(t=te/100*(r-a-L))+X,_(r),R(a),T(a+L),q(l),ie(n),U(t)},be=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,r,l,i,o,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.length>0)){e.next=17;break}n=0;case 2:if(!(n<t.length)){e.next=17;break}return e.next=5,Ce(t[n].product_id);case 5:t[n].product_name=e.sent,r=ye(Number(t[n].trade_price)),l=ye(Number(t[n].qty)),i=ye(Number(t[n].discount_profit)),o=ye(r*l*i/100),s=ye(r*l-o),t[n].totalPrice=ye(r*l),t[n].discountedAmount=o,t[n].netPrice=s;case 14:n++,e.next=2;break;case 17:ue(t);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){pe(null),ge(!1)},Se=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.z,{label:"No",icon:"pi pi-times",className:"p-button-text",onClick:Ne}),(0,O.jsx)(v.z,{label:"Yes",icon:"pi pi-check",className:"p-button-text",onClick:function(){d(fe),ge(!1)}})]}),Ce=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Z.getProductById(t);case 2:return n=e.sent,e.abrupt("return",n?n.name:"");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("table",{className:"col-12",children:(0,O.jsxs)("tbody",{children:[(0,O.jsxs)("tr",{children:[(0,O.jsx)("td",{children:(0,O.jsx)("b",{children:"Total Quantity:"})}),(0,O.jsx)("td",{children:t?t.length:0}),(0,O.jsx)("td",{children:(0,O.jsx)("b",{children:"Gross Amount:"})}),(0,O.jsx)("td",{children:ye(C)}),(0,O.jsx)("td",{children:(0,O.jsx)("b",{children:"Total Discount :"})}),(0,O.jsx)("td",{children:ye(D)}),(0,O.jsx)("td",{children:(0,O.jsx)("b",{children:"Net Amount:"})}),(0,O.jsx)("td",{children:(0,O.jsx)(w.C,{value:ye(le),size:"large",severity:"success"})})]}),(0,O.jsxs)("tr",{children:[(0,O.jsxs)("td",{class:"vatInput",children:[(0,O.jsx)("b",{children:"Vat %"}),(0,O.jsx)(E.R,{readOnly:!n,value:h,placeholder:"VAT %",max:100,min:0,className:"mx-2",style:{width:"fit-content(20em)"},onValueChange:function(e){return function(e){ne(e);var n=(0,r.Z)(t);je(n),m(e)}(e.value)}}),(0,O.jsx)("b",{children:":"})]}),(0,O.jsx)("td",{children:ye(W)}),(0,O.jsx)("td",{children:(0,O.jsx)("b",{children:"Delivery Cost:"})}),(0,O.jsx)("td",{class:"vatInput",children:(0,O.jsx)(E.R,{readOnly:!n,value:x,placeholder:"Delivery Cost %",max:100,min:0,className:"mx-2",style:{width:"fit-content(20em)"},onValueChange:function(e){return function(e){J(e);var n=(0,r.Z)(t);je(n),f(e)}(e.value)}})}),(0,O.jsx)("td",{children:(0,O.jsx)("b",{children:"Discount:"})}),(0,O.jsx)("td",{class:"vatInput",children:(0,O.jsx)(E.R,{value:g,placeholder:"",max:100,min:0,className:"mx-2",style:{width:"fit-content(20em)"},onValueChange:function(e){return function(e){T(I+e),V(e);var n=(0,r.Z)(t);je(n),p(e)}(e.value)}})})]})]})}),(0,O.jsxs)(b.w,{value:ce,stripedRows:!0,showGridlines:!0,scrollable:!0,scrollHeight:"25rem",children:[(0,O.jsx)(j.s,{body:function(e){var t=!!l&&e.qty-e.return_qty>0;return(0,O.jsxs)(O.Fragment,{children:[n&&(0,O.jsx)(v.z,{icon:"pi pi-pencil",className:"p-button-rounded p-button-success mr-2",onClick:function(){return u(e)}}),n&&(0,O.jsx)(v.z,{icon:"pi pi-trash",className:"p-button-rounded p-button-warning",onClick:function(){return d(e)}}),t&&(0,O.jsx)(v.z,{icon:"pi pi-minus",className:"p-button-rounded p-button-warning",onClick:function(){return o(e)}})]})},frozen:!0,headerStyle:{minWidth:"6.4rem"}}),(0,O.jsx)(j.s,{field:"product_name",frozen:!0,header:"Product Name",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"qty",header:"Quantity",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"return_qty",header:"Returned",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"trade_price",header:"Trade Price",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"totalPrice",header:"Total Price",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"discount_profit",header:"Discount (%)",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"discountedAmount",header:"Discounted Amount",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"netPrice",header:"Net Cost",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"lastTradePrice",header:"Last Sale Price",headerStyle:{minWidth:"10rem"}}),(0,O.jsx)(j.s,{field:"remarks",header:"Remarks",headerStyle:{minWidth:"10rem"}})]}),(0,O.jsx)(N.V,{visible:xe,style:{width:"450px"},header:"Confirm",modal:!0,footer:Se,onHide:Ne,children:(0,O.jsxs)("div",{className:"flex align-items-center justify-content-center",children:[(0,O.jsx)("i",{className:"pi pi-exclamation-triangle mr-3",style:{fontSize:"2rem"}}),(0,O.jsx)("span",{children:"Are you sure you want to delete?"})]})})]})},T=n(3985);function K(e){var t=e.salesItems,n=e.editMode,r=e.returnMode,o=e.onReturnItem,u=e.selectedItem,m=e.addSalesItem,p=e.updateSalesItem,h=e.removeSalesItem,x=e.selectProductFromList,g=e.deselectProductFromList,j=e.onChangeVat,b=e.onChangeDeliveryCost,N=e.onChangeAdditionalDiscount,S=e.vat,C=e.deliveryCost,_=e.addDiscount,A=(0,d.cI)({defaultValues:{}}),P=(A.register,A.control),I=A.formState.errors,R=A.reset,F=A.setValue,w=A.handleSubmit,k=(0,c.useRef)(null),T=(0,c.useState)(null),K=(0,s.Z)(T,2),M=K[0],L=K[1],V=(0,c.useState)(""),z=(0,s.Z)(V,2),B=z[0],q=z[1],H=(0,c.useState)(0),Q=(0,s.Z)(H,2),W=Q[0],U=Q[1],G=(0,c.useState)(0),Y=(0,s.Z)(G,2),X=Y[0],J=Y[1],$=(0,c.useState)(!1),ee=(0,s.Z)($,2),te=ee[0],ne=ee[1],re=(0,c.useState)(null),ae=(0,s.Z)(re,2),le=ae[0],ie=ae[1],oe=function(){R({product_id:"",bar_code:"",qty:1,min_price:0,trade_price:0,remarks:"",totalPrice:0,discount_profit:0,discountedAmount:0,netPrice:0,lastTradePrice:0}),L(null),U(0),se("",0)},se=function(e,t){console.log("setProductAndItsStock",e,t),q(e),J(t)};(0,c.useEffect)((function(){if(console.log("salesItems-UPDATED::",t),t&&t.length>0){var e=0;t.forEach((function(t){e+=Number(t.netPrice)})),console.log("_total::",e)}}),[t]),(0,c.useEffect)((function(){u&&u.id?(ne(!1),de(u)):oe()}),[u]);var ce=function(e){e.totalPrice=(0,Z.QV)(Number(e.trade_price)*Number(e.qty)),e.discountedAmount=(0,Z.QV)(e.totalPrice*Number(e.discount_profit)/100),e.netPrice=(0,Z.QV)(e.totalPrice-e.discountedAmount),L(e),F("totalPrice",e.totalPrice),F("discountedAmount",e.discountedAmount),F("netPrice",e.netPrice)},ue=function(e,t){var n=e.target&&e.target.value||0,r=(0,l.Z)({},M);r["".concat(t)]=n,ce(r),F(t,n)},de=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("selectProduct::",t),n=t.current_stock,(r=(0,l.Z)({},M)).product_id=t.id,r.product_name=t.name,r.min_price=t.min_price,r.trade_price=t.trade_price,r.current_stock=n,r.qty=t.qty||1,r.discount_profit=t.discount_profit||0,r.remarks=t.remarks||"",r.lastTradePrice=t.lastTradePrice,L(r),R((0,l.Z)({},r)),U(t.min_price),se(t.name,n),k.current.focus(),ce(r);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(e){return I[e]&&(0,O.jsx)("small",{className:"p-error",children:I[e].message})};return(0,O.jsxs)(O.Fragment,{children:[n&&(0,O.jsxs)("div",{className:"card p-fluid formgrid grid",children:[(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"product_id",control:P,rules:{required:"Product is required."},render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Product Name*"}),(0,O.jsx)(f.o,{readonly:"true",value:B,placeholder:"Select Product"}),(0,O.jsx)(f.o,{hidden:!0,inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error})}),me(t.name)]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"lastTradePrice",control:P,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Last Trade Price"}),(0,O.jsx)(E.R,{inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error}),disabled:!0})]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"min_price",control:P,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Min Trade Price"}),(0,O.jsx)(f.o,{inputId:t.name,value:t.value,inputRef:t.ref,disabled:!0,className:(0,y.AK)({"p-invalid":n.error})}),me(t.name)]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"trade_price",control:P,rules:{required:"Trade Price is required.",min:{value:W,message:"Must be less than or equal to current stock."}},render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Trade Price"}),(0,O.jsx)(E.R,{ref:k,onFocus:function(e){return e.target.select()},inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error}),onValueChange:function(e){return ue(e,"trade_price")},min:W,max:1e7})]})}})}),(0,O.jsxs)("div",{className:"field col-12 md:col-2",children:[(0,O.jsx)("label",{children:"Current Stock"}),(0,O.jsx)(f.o,{readonly:"true",value:X,placeholder:"Current Stock"})]}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"qty",control:P,rules:{required:"Quantity is required.",max:{value:X,message:"Must be less than or equal to current stock."}},render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Quantity"}),(0,O.jsx)(E.R,{ref:k,onFocus:function(e){return e.target.select()},inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error}),onValueChange:function(e){return ue(e,"qty")},min:1,max:1e7})]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"totalPrice",control:P,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Total Price"}),(0,O.jsx)(E.R,{inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error}),disabled:!0})]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"discount_profit",control:P,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Discount %"}),(0,O.jsx)(E.R,{onFocus:function(e){return e.target.select()},inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error}),onValueChange:function(e){return ue(e,"discount_profit")},min:0,maxFractionDigits:2})]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(d.Qr,{name:"netPrice",control:P,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Net Price"}),(0,O.jsx)(E.R,{inputId:t.name,value:t.value,inputRef:t.ref,className:(0,y.AK)({"p-invalid":n.error}),disabled:!0})]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-4",children:(0,O.jsx)(d.Qr,{name:"remarks",control:P,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":I.value}),children:"Remarks"}),(0,O.jsx)(f.o,{inputId:t.name,value:t.value,inputRef:t.ref,onChange:function(e){return ue(e,"remarks")},disabled:!0,className:(0,y.AK)({"p-invalid":n.error})})]})}})}),(0,O.jsxs)("div",{className:" field col-12 md:col-2 align-items-center",children:[te&&(0,O.jsx)(v.z,{label:"Update",className:"p-button-primary mr-2",onClick:w((function(e){return t=e,ne(!1),oe(),void p(t,le);var t}))}),!te&&(0,O.jsx)(v.z,{type:"submit",label:"Add",className:"p-button-primary",onClick:w((function(e){return t=e,oe(),void m(t);var t}))}),(0,O.jsx)(v.z,{label:"Cancel",className:"p-button-outlined p-button-warning mt-2",onClick:function(){return ne(!1),oe(),void g()}})]})]}),(0,O.jsx)(D,{salesItems:t,editMode:n,returnMode:r,onReturnItem:function(e){return o(e)},onEdit:function(e){return t=e,console.log("editSalesProduct::",t),ne(!0),ie(t.index),de({id:t.product_id,name:t.product_name,min_price:t.min_price,trade_price:t.trade_price,current_stock:t.current_stock,qty:t.qty,discount_profit:t.discount_profit,remarks:t.remarks,lastTradePrice:t.lastTradePrice}),void x(t.product_id);var t},onDelete:function(e){return function(e){h(e)}(e)},onChangeVat:function(e){return j(e)},onChangeDeliveryCost:function(e){return b(e)},onChangeAdditionalDiscount:function(e){return N(e)},vat:S,deliveryCost:C,addDiscount:_})]})}var M=n(1412),L=n(8998),V=function(e){var t=e.trigger,n=e.onCancelOrder,r=(0,c.useState)(!1),a=(0,s.Z)(r,2),l=a[0],i=a[1],o=(0,d.cI)({defaultValues:{charge:0,reason:""}}),u=o.control,m=o.formState.errors,f=o.setValue,h=o.handleSubmit;(0,c.useEffect)((function(){t&&(f("charge",0),f("reason",""),x())}),[t]);var x=function(){i(!0)},g=function(e){return m[e]&&(0,O.jsx)("small",{className:"p-error",children:m[e].message})},j=function(){i(!1)},b=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.z,{label:"Cancel",icon:"pi pi-times",className:"p-button-text",onClick:j}),(0,O.jsx)(v.z,{label:"Save",icon:"pi pi-check",className:"p-button-text",onClick:h((function(e){return function(e){console.log("submitCancelOrder",e);var t={charge:e.charge,reason:e.reason};n(t),i(!1)}(e)}))})]});return(0,O.jsx)(N.V,{visible:l,style:{width:"450px"},header:"CancelOrder",modal:!0,className:"p-fluid",footer:b,onHide:j,children:(0,O.jsxs)("div",{className:"p-fluid formgrid grid",children:[(0,O.jsx)("div",{className:"field col-12 md:col-12",children:(0,O.jsx)(d.Qr,{name:"charge",control:u,rules:{validate:function(e){return e>0||"Enter a valid amount."}},render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:"charge",children:"Cancellation Fee*"}),(0,O.jsx)(E.R,{inputId:t.name,value:t.value,inputRef:t.ref,onValueChange:function(e){return t.onChange(e)},className:(0,y.AK)({"p-invalid":n.error})}),g(t.name)]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-12",children:(0,O.jsx)(d.Qr,{name:"reason",control:u,rules:{required:"Reason is required."},render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:"reason",children:"Reason*"}),(0,O.jsx)(p.g,{inputId:t.name,value:t.value,inputRef:t.ref,onChange:function(e){return t.onChange(e.target.value)},className:(0,y.AK)({"p-invalid":n.error})}),g(t.name)]})}})})]})})},z=c.memo((function(e){var t=e.sales,n=(0,c.useRef)(null),Z=(0,u.s0)(),E=(0,c.useState)(null),w=(0,s.Z)(E,2),k=w[0],D=w[1],z=(0,c.useState)(!1),B=(0,s.Z)(z,2),q=B[0],H=B[1],Q=(0,c.useState)("draft"),W=(0,s.Z)(Q,2),U=W[0],G=W[1],Y=(0,c.useState)("draft"),X=(0,s.Z)(Y,2),J=X[0],$=X[1],ee=(0,c.useState)([]),te=(0,s.Z)(ee,2),ne=te[0],re=te[1],ae=(0,c.useState)([]),le=(0,s.Z)(ae,2),ie=le[0],oe=le[1],se=(0,c.useState)(0),ce=(0,s.Z)(se,2),ue=ce[0],de=ce[1],me=(0,c.useState)(0),fe=(0,s.Z)(me,2),pe=fe[0],he=fe[1],ve=(0,c.useState)(0),xe=(0,s.Z)(ve,2),ge=xe[0],ye=xe[1],je=(0,c.useState)({}),be=(0,s.Z)(je,2),Ne=be[0],Se=be[1],Ce=(0,c.useState)(null),_e=(0,s.Z)(Ce,2),Ae=_e[0],Pe=_e[1],Ie=(0,c.useState)(null),Re=(0,s.Z)(Ie,2),Fe=(Re[0],Re[1]),Ze=(0,c.useState)(!1),Ee=(0,s.Z)(Ze,2),we=Ee[0],ke=(Ee[1],(0,c.useState)(0)),Oe=(0,s.Z)(ke,2),De=Oe[0],Te=Oe[1],Ke=(0,c.useState)("WALKIN"),Me=(0,s.Z)(Ke,2),Le=Me[0],Ve=Me[1],ze=(0,c.useState)(null),Be=(0,s.Z)(ze,2),qe=Be[0],He=Be[1],Qe=(0,c.useState)(null),We=(0,s.Z)(Qe,2),Ue=We[0],Ge=We[1],Ye=(0,c.useState)(null),Xe=(0,s.Z)(Ye,2),Je=Xe[0],$e=Xe[1],et=(0,c.useState)(!1),tt=(0,s.Z)(et,2),nt=tt[0],rt=tt[1],at=(0,c.useState)(null),lt=(0,s.Z)(at,2),it=lt[0],ot=lt[1],st=(0,c.useState)(0),ct=(0,s.Z)(st,2),ut=ct[0],dt=ct[1],mt=(0,c.useState)(null),ft=(0,s.Z)(mt,2),pt=ft[0],ht=ft[1],vt=(0,c.useState)(null),xt=(0,s.Z)(vt,2),gt=xt[0],yt=xt[1],jt=(0,c.useState)(null),bt=(0,s.Z)(jt,2),Nt=bt[0],St=bt[1],Ct=(0,c.useState)(null),_t=(0,s.Z)(Ct,2),At=_t[0],Pt=_t[1],It=(0,c.useState)(!1),Rt=(0,s.Z)(It,2),Ft=Rt[0],Zt=Rt[1],Et=(0,c.useState)({}),wt=(0,s.Z)(Et,2),kt=wt[0],Ot=wt[1],Dt=(0,c.useState)([]),Tt=(0,s.Z)(Dt,2),Kt=Tt[0],Mt=Tt[1],Lt=(0,c.useState)([]),Vt=(0,s.Z)(Lt,2),zt=Vt[0],Bt=Vt[1],qt=(0,c.useState)(0),Ht=(0,s.Z)(qt,2),Qt=Ht[0],Wt=Ht[1],Ut=(0,c.useState)(!1),Gt=(0,s.Z)(Ut,2),Yt=Gt[0],Xt=Gt[1],Jt=(0,c.useState)(null),$t=(0,s.Z)(Jt,2),en=$t[0],tn=$t[1],nn=(0,c.useState)(0),rn=(0,s.Z)(nn,2),an=rn[0],ln=rn[1],on={fields:["id","name","code","bar_code","brand_name","model_no","part_number","current_stock","min_price","price"],first:0,rows:10,page:1,sortField:null,sortOrder:null,filters:{global:{value:null,matchMode:h.a6.CONTAINS},name:{value:null,matchMode:h.a6.CONTAINS},brandName:{value:null,matchMode:h.a6.CONTAINS},modelNo:{value:null,matchMode:h.a6.CONTAINS},partNumber:{value:null,matchMode:h.a6.CONTAINS}}},sn={payment_date:m().format("YYYY-MM-DD"),payment_no:null,payment_type:"",payment_method:"CASH",ref_type:"",ref_id:null,bank_account_id:null,current_balance:0,amount:0,reference:"",remarks:""},cn=new L.p,un=new T.M,dn=new M.e,mn=(0,d.cI)({defaultValues:{}}),fn=mn.control,pn=mn.formState.errors,hn=mn.reset,vn=mn.setValue,xn=mn.handleSubmit;(0,c.useEffect)((function(){Pn()}),[]),(0,c.useEffect)((function(){null===t||void 0===t?(null===k&&dn.getNextId(I.Id).then((function(e){D(e.nextID)})),H(!0)):(console.log("FETCHED-SALES::",t),D(t.voucher_no),re(t.items),Bt(t.return_items),H("draft"===t.status),Ve(t.customer_category),Ge(t.last_trx_id),Zt("approved"===t.status&&"completed"===t.trx_status),de(Number(t.duty_vat)),he(Number(t.transport)),ye(Number(t.additional_discount)),_n(t.party_id),hn({notes:t.notes,party_id:t.party_id,customer_name:t.customer_name,customer_phone:t.customer_phone,customer_category:t.customer_category}))}),[t]);var gn=function(){hn({customer_category:"WALKIN",notes:"",party_id:"",customer_phone:"",customer_name:""})},yn=function(e){return{product_id:e.product_id,qty:e.qty,discount_profit:e.discount_profit,trade_price:e.trade_price,net_price:e.net_price}},jn=function(e){console.log("submitSalesData::",e);var r=function(e){var t,n=[],r=(0,o.Z)(ne);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(yn(a))}}catch(i){r.e(i)}finally{r.f()}var l=pt;return{voucher_no:k,customer_category:e.customer_category,party_id:e.party_id,customer_name:e.customer_name,last_trx_id:Ue,customer_phone:e.customer_phone,notes:e.notes,status:U,trx_status:J,items:n,payment:l,duty_vat:ue,transport:pe,additional_discount:ge}}(e);console.log("_sales::",r);try{t&&t.id?"approved"===r.status?"CONDITIONAL"===Le&&"completed"===r.trx_status?cn.confirmPayment(t.id,r).then((function(e){n.current.show({severity:"success",summary:"Successful",detail:"Sales Record Committed",life:3e3}),Z("/sales/invoice/"+t.id)})):cn.commit(I.Id,t.id,r).then((function(e){n.current.show({severity:"success",summary:"Successful",detail:"Sales Record Committed",life:3e3}),Z("/sales/invoice/"+t.id)})):cn.update(I.Id,t.id,r).then((function(e){n.current.show({severity:"success",summary:"Successful",detail:"Sales Record Updated",life:3e3}),Z("/sales")})):cn.create(I.Id,r).then((function(e){n.current.show({severity:"success",summary:"Successful",detail:"Sales Record Created",life:3e3}),Z("/sales")}))}catch(a){console.log(a),n.current.show({severity:"error",summary:"Error",detail:"Failed to create Sales Record!",life:3e3})}},bn=function(){var e,t,n=0,r=0;return console.log("SALES-ITEMS:::",ne),ne.forEach((function(e){n+=e.trade_price*e.qty,r+=Number(e.trade_price)*Number(e.qty)*Number(e.discount_profit)/100})),t=ue/100*(n-r),e=n-r+Number(t)+Number(pe)-Number(ge),{gross:n,discount:r,additional_discount:ge,transport:pe,duty_vat:t,net:e}},Nn=function(){Pe(null),Fe(null),Se(null)},Sn=function(e){Se({id:e})},Cn=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var r,i,s,c,u,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.value,e.next=3,un.getById(r.id);case 3:if(i=e.sent,r.current_stock=i.current_stock,r.price=i.price,r.min_price=i.min_price,console.log("productSelected::",r),console.log("selectedCustomer::",qe),null===qe&&"WALKIN"!==Le){e.next=45;break}if(!we){e.next=13;break}return n.current.show({severity:"warn",summary:"Please Cancel the update",detail:"Product in update",life:3e3}),e.abrupt("return");case 13:console.log("salesItems::",ne),s=(0,o.Z)(ne),e.prev=15,s.s();case 17:if((c=s.n()).done){e.next=25;break}if(c.value.product_id!==r.id){e.next=23;break}return n.current.show({severity:"warn",summary:"Already Added",detail:"Product Already Added",life:3e3}),Nn(),e.abrupt("return");case 23:e.next=17;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(15),s.e(e.t0);case 30:return e.prev=30,s.f(),e.finish(30);case 33:if(u=0,null===qe){e.next=39;break}return e.next=38,cn.getOrderProductLastPrice("trxSales",r.id,qe._id);case 38:u=e.sent;case 39:Sn(r.id),d=(0,l.Z)((0,l.Z)({},r),{},{trade_price:Number(r.price),current_stock:Number(r.current_stock),min_price:Number(r.min_price),lastTradePrice:Number(u)}),console.log("setSelectedProductItem::",d),Pe(d),e.next=46;break;case 45:n.current.show({severity:"warn",summary:"Please Select Customer",detail:"Select a Customer First",life:3e3});case 46:case"end":return e.stop()}}),e,null,[[15,27,30,33]])})));return function(t){return e.apply(this,arguments)}}(),_n=function(e){console.log("getPartyBalance-PartyID::",e),null!==e&&void 0!==e&&""!==e&&cn.getLedgerBalance("trxACReceivable",e).then((function(e){if(console.log("balance::",e),e){var t=Number(e.dr_amount)||0,n=Number(e.cr_amount)||0;$e(t-n)}}))},An=function(e){console.log("onCustomerSelect::",e),Ge(e.last_trx_id),He(e),_n(e._id)},Pn=function(){gn(),Nn(),re([]),He(null),Ve("WALKIN"),Te(De+1)},In=function(e,t){console.log("onSubmit::",e,t),ne.length<1?n.current.show({severity:"error",summary:"Error",detail:"No Product Added",life:3e3}):(St(e),Pt(t),"save"===e?(G("draft"),ot("Are you sure you want to save this order?"),rt(nt+1)):"cancel"===e?(G("cancelled"),$("cancelled"),ot("Are you sure you want to cancel this order?"),"CONDITIONAL"===Le?ln(an+1):rt(nt+1)):"approve"===e?(G("approved"),$("CONDITIONAL"===Le?"pending":"completed"),ot("Are you sure you want to approve this order?"),rt(nt+1)):"confirm_payment"==e&&(G("approved"),$("completed"),console.log("confirm_payment::",t),ot("Are you sure you want to complete this order?"),rt(nt+1)))},Rn=function(){Xt(!1)},Fn=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.z,{label:"No",icon:"pi pi-times",className:"p-button-text",onClick:Rn}),(0,O.jsx)(v.z,{label:"Yes",icon:"pi pi-check",className:"p-button-text",onClick:function(){console.log("COFIRM RETURN ITEMS::",Kt),cn.return(I.Id,t.id,Kt).then((function(e){n.current.show({severity:"success",summary:"Successful",detail:"Purchase Record Created",life:3e3}),Z("/sales")}))}})]}),Zn=function(e){return pn[e]&&(0,O.jsx)("small",{className:"p-error",children:pn[e].message})},En=function(e){return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(v.z,{icon:"pi pi-trash",className:"p-button-rounded p-button-warning",onClick:function(){return function(e){console.log("DELETE RETURN ITEM::",e);var t=(0,r.Z)(Kt);t.splice(e.index,1),Mt(t)}(e)}})})};return(0,O.jsxs)("div",{className:"grid h-screen",children:[(0,O.jsx)(x.F,{ref:n}),(0,O.jsxs)("div",{className:"card col-5",children:[!t&&(0,O.jsx)(v.z,{className:"p-button-outlined",label:"Go to Sales List",onClick:function(){return Z("/sales")}}),(0,O.jsxs)("h5",{children:["Sale Detail :: VoucherNo (",k,")",t&&(0,O.jsx)(g.V,{severity:"warning",value:t.status})]}),(0,O.jsx)(O.Fragment,{children:q&&(0,O.jsx)("div",{className:"card col-12 md:col-12",children:(0,O.jsx)(_.Z,{displayField:"name",fieldValue:"",scrollHeight:"300px",defaultFilters:on,modelName:I.sf,caption:"Select Product",selectedItem:Ne,showFields:[],onSelect:Cn,columns:[{field:"name",header:"Product Name",filterPlaceholder:"Filter by Product Name",width:"50rem"},{field:"brand_name",header:"Brand Name",filterPlaceholder:"Filter by Barnd Name",width:"15rem"},{field:"model_no",header:"Model No",filterPlaceholder:"Filter by Model No",width:"15rem"},{field:"part_number",header:"Part Number",filterPlaceholder:"Filter by Part Number",width:"15rem"},{field:"category_name",header:"Product Category",filterPlaceholder:"Filter by Product Category",width:"15rem"}]})})}),(0,O.jsx)("div",{className:"card col-12 md:col-12",children:(0,O.jsxs)("div",{className:"p-fluid formgrid grid",children:[function(){var e=!1;return t&&"draft"!==t.status&&(e=!0),(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)("div",{className:"field col-12 md:col-4",children:[e&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{children:"Customer Category"}),(0,O.jsx)(f.o,{readOnly:"true",value:t.customer_category,placeholder:"empty"})]}),!e&&(0,O.jsx)(d.Qr,{name:"customer_category",control:fn,render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":pn.value}),children:"Customer Category"}),(0,O.jsx)(C.Z,{field:t,data:P.Ey,onSelectChange:function(e){return function(e){gn(),He(null),Ve(e),Ge(null),$e(null),vn("customer_category",e)}(e)},className:(0,y.AK)({"p-invalid":n.error})}),Zn(t.name)]})}})]}),(0,O.jsx)("div",{className:"field col-12 md:col-8",children:(0,O.jsx)(d.Qr,{name:"notes",control:fn,render:function(t){var n=t.field,r=t.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:n.name,className:(0,y.AK)({"p-error":pn.value}),children:"Notes"}),(0,O.jsx)(p.g,{readOnly:e,inputId:n.name,value:n.value,inputRef:n.ref,onChange:function(e){return n.onChange(e.target.value)},className:(0,y.AK)({"p-invalid":r.error})})]})}})}),"WALKIN"===Le&&(0,O.jsxs)("div",{className:"grid col-12 md:col-12",children:[(0,O.jsx)("div",{className:"field col-12 md:col-6",children:(0,O.jsx)(d.Qr,{name:"customer_phone",control:fn,rules:{required:"Mobile Number is required."},render:function(t){var n=t.field,r=t.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:n.name,className:(0,y.AK)({"p-error":pn.value}),children:"Mobile Number"}),(0,O.jsx)(f.o,{readOnly:e,inputId:n.name,value:n.value,inputRef:n.ref,onChange:function(e){return n.onChange(e.target.value)},className:(0,y.AK)({"p-invalid":r.error})}),Zn(n.name)]})}})}),(0,O.jsx)("div",{className:"field col-12 md:col-6",children:(0,O.jsx)(d.Qr,{name:"customer_name",control:fn,render:function(t){var n=t.field,r=t.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:n.name,className:(0,y.AK)({"p-error":pn.value}),children:"Name"}),(0,O.jsx)(f.o,{readOnly:e,inputId:n.name,value:n.value,inputRef:n.ref,onChange:function(e){return n.onChange(e.target.value)},className:(0,y.AK)({"p-invalid":r.error})})]})}})})]}),"WALKIN"!==Le&&(0,O.jsxs)("div",{className:"grid col-12 md:col-12",children:[(0,O.jsxs)("div",{className:"field col-12 md:col-6",children:[e&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{children:"Customer"}),(0,O.jsx)(f.o,{readonly:"true",value:t.party_id,placeholder:"empty"})]}),!e&&(0,O.jsx)(d.Qr,{name:"party_id",control:fn,rules:{required:"Custmer is required."},render:function(e){var t=e.field,n=e.fieldState;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("label",{htmlFor:t.name,className:(0,y.AK)({"p-error":pn.value}),children:"Customer*"}),(0,O.jsx)(A.Z,{field:t,modelName:I.CZ,displayField:"name",onSelect:An,className:(0,y.AK)({"p-invalid":n.error}),columns:[{field:"name",header:"Customer Name",filterPlaceholder:"Filter by Customer Name"}]}),Zn(t.name)]})}})]}),(0,O.jsxs)("div",{className:"field col-12 md:col-3",children:[(0,O.jsx)("label",{children:"Last Voucher"}),(0,O.jsx)(f.o,{value:Ue,readOnly:!0})]}),(0,O.jsxs)("div",{className:"field col-12 md:col-3",children:[(0,O.jsx)("label",{children:"Balance"}),(0,O.jsx)(f.o,{value:Je,readOnly:!0})]})]})]})}(),function(){var e=!0,r=!1,a=!1,i=!1;return t&&(e=!1,"draft"===t.status?r=!0:"approved"===t.status&&("CONDITIONAL"===Le&&"pending"===t.trx_status?i=!0:a=!0)),(0,O.jsxs)(O.Fragment,{children:[(e||r)&&(0,O.jsx)("div",{className:"field col-12 md:col-2",children:(0,O.jsx)(v.z,{type:"submit",label:"Clear",className:"p-button-outlined p-button-warning",onClick:function(){return Pn()}})}),(r||i)&&(0,O.jsx)("div",{className:"field col-12 md:col-3",children:(0,O.jsx)(v.z,{type:"submit",label:"Cancel Order",className:"p-button-outlined p-button-danger",onClick:xn((function(e){return In("cancel",e)}))})}),(e||r)&&(0,O.jsx)("div",{className:"field col-12 md:col-3",children:(0,O.jsx)(v.z,{type:"submit",label:"Save Order",className:"p-button p-button-success",onClick:xn((function(e){return In("save",e)}))})}),(e||r)&&(0,O.jsx)("div",{className:"field col-12 md:col-4",children:(0,O.jsx)(v.z,{type:"submit",label:"Confirm Order",className:"p-button p-button-info",onClick:xn((function(e){return function(e){if(console.log("customerCategory::",Le),oe(e),"REGISTERED"===Le)In("approve",e);else if("WALKIN"===Le){var t=bn();console.log("DATA::",t),yt((0,l.Z)((0,l.Z)({},sn),{current_balance:t.net,amount:t.net})),console.log("InitPayment::",gt),dt(ut+1)}else"CONDITIONAL"===Le&&In("approve",e)}(e)}))})}),i&&(0,O.jsx)("div",{className:"field col-12 md:col-4",children:(0,O.jsx)(v.z,{type:"submit",label:"Confirm Payment",className:"p-button p-button-info",onClick:xn((function(e){return function(){console.log("confirmPayment::",pt);var e=bn();console.log("DATA::",e),yt((0,l.Z)((0,l.Z)({},sn),{ref_type:"dtCustomer",ref_id:t.party_id,current_balance:e.net,amount:e.net})),console.log("InitPayment::",gt),dt(ut+1)}()}))})}),a&&(0,O.jsx)("div",{className:"field col-12 md:col-4",children:(0,O.jsx)(v.z,{type:"submit",label:"Confirm Return",className:"p-button p-button-info",onClick:xn((function(e){0!==Kt.length?Xt(!0):n.current.show({severity:"error",summary:"Error",detail:"Please select at least one item to return",life:3e3})}))})})]})}()]})})]}),(0,O.jsxs)("div",{className:"card col-7",children:[(0,O.jsx)(K,{salesItems:ne,editMode:q,returnMode:Ft,onReturnItem:function(e){return t=e,console.log("SELECTED RETURN ITEM::",t),Ot(t),void Wt((function(e){return e+1}));var t},addSalesItem:function(e){return function(e){var t=(0,r.Z)(ne);e.index=ne.length,t.push(e),re(t)}(e)},updateSalesItem:function(e,t){return function(e,t){var n=(0,r.Z)(ne);e.index=t,n[t]=e,re(n)}(e,t)},removeSalesItem:function(e){return function(e){var t=(0,r.Z)(ne);t.splice(e,1),t.forEach((function(e,t){e.index=t})),re(t)}(e)},deselectProductFromList:function(){Nn()},selectProductFromList:function(e){return Sn(e)},selectedItem:Ae,onChangeVat:function(e){return de(e)},onChangeDeliveryCost:function(e){return he(e)},onChangeAdditionalDiscount:function(e){return ye(e)},vat:void 0===t?0:t.duty_vat,deliveryCost:void 0===t?0:t.transport,addDiscount:void 0===t?0:t.additional_discount}),(0,O.jsx)(S.Z,{message:it,trigger:nt,onConfirm:function(){"cancel"===Nt?cn.cancel(I.Id,t.id,en).then((function(e){n.current.show({severity:"success",summary:"Successful",detail:"Sales Record Cancelled",life:3e3})})):(console.log("onConfirmClick::",Nt,At),jn(At))}}),(0,O.jsx)(R.Z,{trigger:ut,initPayment:gt,readOnly:"WALKIN"===Le,onPaymnetCallback:function(e){console.log("onPaymnetCallback",e),ht(e),In("CONDITIONAL"===Le?"confirm_payment":"approve",ie)}}),(0,O.jsx)(V,{trigger:an,onCancelOrder:function(e){return t=e,console.log("cancelOrderWithCharge::",t),tn(t),void rt(nt+1);var t}}),(0,O.jsxs)(O.Fragment,{children:[Kt&&Kt.length>0&&(0,O.jsxs)("div",{className:"col-12",children:[(0,O.jsx)("h5",{children:"New Returns:"}),(0,O.jsxs)(b.w,{value:Kt,stripedRows:!0,showGridlines:!0,scrollable:!0,scrollHeight:"25rem",children:[(0,O.jsx)(j.s,{body:En,frozen:!0,headerStyle:{minWidth:"6.4rem"}}),(0,O.jsx)(j.s,{field:"product_name",header:"Product Name",sortable:!0}),(0,O.jsx)(j.s,{field:"return_qty",header:"Returned Qty",sortable:!0}),(0,O.jsx)(j.s,{field:"reason",header:"Reason",sortable:!0})]})]}),zt&&zt.length>0&&(0,O.jsxs)("div",{className:"col-12",children:[(0,O.jsx)("h5",{children:"Returned Items:"}),(0,O.jsxs)(b.w,{value:zt,stripedRows:!0,showGridlines:!0,scrollable:!0,scrollHeight:"25rem",children:[(0,O.jsx)(j.s,{field:"product_name",header:"Product Name",sortable:!0}),(0,O.jsx)(j.s,{field:"return_qty",header:"Returned Qty",sortable:!0}),(0,O.jsx)(j.s,{field:"reason",header:"Reason",sortable:!0}),(0,O.jsx)(j.s,{field:"created_at",header:"Returned Date",sortable:!0})]})]}),(0,O.jsx)(F.Z,{trigger:Qt,selectedReturnItem:kt,onAddReturnItem:function(e){return function(e){console.log("SELECTED RETURN ITEM::",e),e.index=Kt.length,e.created_at=new Date;for(var t=0;t<Kt.length;t++)if(Kt[t].product_id===e.product_id)return void n.current.show({severity:"error",summary:"Error",detail:"Item already added!",life:3e3});Mt([].concat((0,r.Z)(Kt),[e]))}(e)}})]}),(0,O.jsx)(N.V,{visible:Yt,style:{width:"450px"},header:"Confirm",modal:!0,footer:Fn,onHide:Rn,children:(0,O.jsxs)("div",{className:"flex align-items-center justify-content-center",children:[(0,O.jsx)("i",{className:"pi pi-exclamation-triangle mr-3",style:{fontSize:"2rem"}}),(0,O.jsx)("span",{children:"Are you sure you want to return these products?"})]})})]})]})})),B=z},7083:function(e,t,n){n.d(t,{C:function(){return u}});var r=n(2791),a=n(5854),l=n(5388),i=n(7890);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}var c=l.V.extend({defaultProps:{__TYPE:"Badge",value:null,severity:null,size:null,style:null,className:null,children:void 0}}),u=r.memo(r.forwardRef((function(e,t){var n,l,o,u=r.useContext(i.Ou),d=c.getProps(e,u),m=c.setMetaData({props:d}).ptm,f=r.useRef(null),p=(0,a.AK)("p-badge p-component",(n={"p-badge-no-gutter":a.gb.isNotEmpty(d.value)&&1===String(d.value).length,"p-badge-dot":a.gb.isEmpty(d.value),"p-badge-lg":"large"===d.size,"p-badge-xl":"xlarge"===d.size},l="p-badge-".concat(d.severity),o=null!==d.severity,(l=s(l))in n?Object.defineProperty(n,l,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[l]=o,n),d.className);r.useImperativeHandle(t,(function(){return{props:d,getElement:function(){return f.current}}}));var h=(0,a.dG)({ref:f,style:d.style,className:p},c.getOtherProps(d),m("root"));return r.createElement("span",h,d.value)})));u.displayName="Badge"},8218:function(e,t,n){n.d(t,{g:function(){return d}});var r=n(2791),a=n(8820),l=n(3574),i=n(5854),o=n(5388),s=n(7890);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}var u=o.V.extend({defaultProps:{__TYPE:"InputTextarea",autoResize:!1,keyfilter:null,onBlur:null,onFocus:null,onBeforeInput:null,onInput:null,onKeyDown:null,onKeyUp:null,onPaste:null,tooltip:null,tooltipOptions:null,validateOnly:!1,children:void 0}}),d=r.memo(r.forwardRef((function(e,t){var n=r.useContext(s.Ou),o=u.getProps(e,n),d=r.useRef(t),m=r.useRef(0),f=u.setMetaData({props:o}).ptm,p=function(e){var t=d.current;t&&i.p7.isVisible(t)&&(m.current||(m.current=t.scrollHeight,t.style.overflow="hidden"),(m.current!==t.scrollHeight||e)&&(t.style.height="",t.style.height=t.scrollHeight+"px",parseFloat(t.style.height)>=parseFloat(t.style.maxHeight)?(t.style.overflowY="scroll",t.style.height=t.style.maxHeight):t.style.overflow="hidden",m.current=t.scrollHeight))};r.useEffect((function(){i.gb.combinedRefs(d,t)}),[d,t]),r.useEffect((function(){o.autoResize&&p(!0)}),[o.autoResize]);var h=r.useMemo((function(){return i.gb.isNotEmpty(o.value)||i.gb.isNotEmpty(o.defaultValue)}),[o.value,o.defaultValue]),v=i.gb.isNotEmpty(o.tooltip),x=(0,i.AK)("p-inputtextarea p-inputtext p-component",{"p-disabled":o.disabled,"p-filled":h,"p-inputtextarea-resizable":o.autoResize},o.className),g=(0,i.dG)({ref:d,className:x,onFocus:function(e){o.autoResize&&p(),o.onFocus&&o.onFocus(e)},onBlur:function(e){o.autoResize&&p(),o.onBlur&&o.onBlur(e)},onKeyUp:function(e){o.autoResize&&p(),o.onKeyUp&&o.onKeyUp(e)},onKeyDown:function(e){o.onKeyDown&&o.onKeyDown(e),o.keyfilter&&a.F.onKeyPress(e,o.keyfilter,o.validateOnly)},onBeforeInput:function(e){o.onBeforeInput&&o.onBeforeInput(e),o.keyfilter&&a.F.onBeforeInput(e,o.keyfilter,o.validateOnly)},onInput:function(e){var t=e.target;o.autoResize&&p(i.gb.isEmpty(t.value)),o.onInput&&o.onInput(e),i.gb.isNotEmpty(t.value)?i.p7.addClass(t,"p-filled"):i.p7.removeClass(t,"p-filled")},onPaste:function(e){o.onPaste&&o.onPaste(e),o.keyfilter&&a.F.onPaste(e,o.keyfilter,o.validateOnly)}},u.getOtherProps(o),f("root"));return r.createElement(r.Fragment,null,r.createElement("textarea",g),v&&r.createElement(l.u,c({target:d,content:o.tooltip},o.tooltipOptions,{pt:f("tooltip")})))})));d.displayName="InputTextarea"},3428:function(e,t,n){n.d(t,{V:function(){return m}});var r=n(2791),a=n(5854),l=n(5388),i=n(7890);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}function c(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=l.V.extend({defaultProps:{__TYPE:"Tag",value:null,severity:null,rounded:!1,icon:null,style:null,className:null,children:void 0}});function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var m=r.forwardRef((function(e,t){var n,l=r.useContext(i.Ou),o=u.getProps(e,l),s=u.setMetaData({props:o}).ptm,m=r.useRef(null),f=(0,a.AK)("p-tag p-component",(c(n={},"p-tag-".concat(o.severity),null!==o.severity),c(n,"p-tag-rounded",o.rounded),n),o.className),p=(0,a.dG)({className:"p-tag-icon"},s("icon")),h=a.Cz.getJSXIcon(o.icon,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p),{props:o});r.useImperativeHandle(t,(function(){return{props:o,getElement:function(){return m.current}}}));var v=(0,a.dG)({ref:m,className:f,style:o.style},u.getOtherProps(o),s("root")),x=(0,a.dG)({className:"p-tag-value"},s("value"));return r.createElement("span",v,h,r.createElement("span",x,o.value),r.createElement("span",null,o.children))}));m.displayName="Tag"}}]);
//# sourceMappingURL=salesForm.2c7e137a.chunk.js.map